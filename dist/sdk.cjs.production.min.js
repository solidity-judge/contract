"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var t,e,n=require("ethers"),r=require("graphql-request"),a=(t=r)&&"object"==typeof t&&"default"in t?t.default:t;function i(){i=function(){return t};var t={},e=Object.prototype,n=e.hasOwnProperty,r=Object.defineProperty||function(t,e,n){t[e]=n.value},a="function"==typeof Symbol?Symbol:{},s=a.iterator||"@@iterator",o=a.asyncIterator||"@@asyncIterator",u=a.toStringTag||"@@toStringTag";function p(t,e,n){return Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}),t[e]}try{p({},"")}catch(t){p=function(t,e,n){return t[e]=n}}function c(t,e,n,a){var i=Object.create((e&&e.prototype instanceof d?e:d).prototype),s=new M(a||[]);return r(i,"_invoke",{value:x(t,n,s)}),i}function y(t,e,n){try{return{type:"normal",arg:t.call(e,n)}}catch(t){return{type:"throw",arg:t}}}t.wrap=c;var l={};function d(){}function m(){}function f(){}var h={};p(h,s,(function(){return this}));var b=Object.getPrototypeOf,v=b&&b(b(C([])));v&&v!==e&&n.call(v,s)&&(h=v);var g=f.prototype=d.prototype=Object.create(h);function w(t){["next","throw","return"].forEach((function(e){p(t,e,(function(t){return this._invoke(e,t)}))}))}function T(t,e){var a;r(this,"_invoke",{value:function(r,i){function s(){return new e((function(a,s){!function r(a,i,s,o){var u=y(t[a],t,i);if("throw"!==u.type){var p=u.arg,c=p.value;return c&&"object"==typeof c&&n.call(c,"__await")?e.resolve(c.__await).then((function(t){r("next",t,s,o)}),(function(t){r("throw",t,s,o)})):e.resolve(c).then((function(t){p.value=t,s(p)}),(function(t){return r("throw",t,s,o)}))}o(u.arg)}(r,i,a,s)}))}return a=a?a.then(s,s):s()}})}function x(t,e,n){var r="suspendedStart";return function(a,i){if("executing"===r)throw new Error("Generator is already running");if("completed"===r){if("throw"===a)throw i;return{value:void 0,done:!0}}for(n.method=a,n.arg=i;;){var s=n.delegate;if(s){var o=k(s,n);if(o){if(o===l)continue;return o}}if("next"===n.method)n.sent=n._sent=n.arg;else if("throw"===n.method){if("suspendedStart"===r)throw r="completed",n.arg;n.dispatchException(n.arg)}else"return"===n.method&&n.abrupt("return",n.arg);r="executing";var u=y(t,e,n);if("normal"===u.type){if(r=n.done?"completed":"suspendedYield",u.arg===l)continue;return{value:u.arg,done:n.done}}"throw"===u.type&&(r="completed",n.method="throw",n.arg=u.arg)}}}function k(t,e){var n=e.method,r=t.iterator[n];if(void 0===r)return e.delegate=null,"throw"===n&&t.iterator.return&&(e.method="return",e.arg=void 0,k(t,e),"throw"===e.method)||"return"!==n&&(e.method="throw",e.arg=new TypeError("The iterator does not provide a '"+n+"' method")),l;var a=y(r,t.iterator,e.arg);if("throw"===a.type)return e.method="throw",e.arg=a.arg,e.delegate=null,l;var i=a.arg;return i?i.done?(e[t.resultName]=i.value,e.next=t.nextLoc,"return"!==e.method&&(e.method="next",e.arg=void 0),e.delegate=null,l):i:(e.method="throw",e.arg=new TypeError("iterator result is not an object"),e.delegate=null,l)}function S(t){var e={tryLoc:t[0]};1 in t&&(e.catchLoc=t[1]),2 in t&&(e.finallyLoc=t[2],e.afterLoc=t[3]),this.tryEntries.push(e)}function L(t){var e=t.completion||{};e.type="normal",delete e.arg,t.completion=e}function M(t){this.tryEntries=[{tryLoc:"root"}],t.forEach(S,this),this.reset(!0)}function C(t){if(t){var e=t[s];if(e)return e.call(t);if("function"==typeof t.next)return t;if(!isNaN(t.length)){var r=-1,a=function e(){for(;++r<t.length;)if(n.call(t,r))return e.value=t[r],e.done=!1,e;return e.value=void 0,e.done=!0,e};return a.next=a}}return{next:D}}function D(){return{value:void 0,done:!0}}return m.prototype=f,r(g,"constructor",{value:f,configurable:!0}),r(f,"constructor",{value:m,configurable:!0}),m.displayName=p(f,u,"GeneratorFunction"),t.isGeneratorFunction=function(t){var e="function"==typeof t&&t.constructor;return!!e&&(e===m||"GeneratorFunction"===(e.displayName||e.name))},t.mark=function(t){return Object.setPrototypeOf?Object.setPrototypeOf(t,f):(t.__proto__=f,p(t,u,"GeneratorFunction")),t.prototype=Object.create(g),t},t.awrap=function(t){return{__await:t}},w(T.prototype),p(T.prototype,o,(function(){return this})),t.AsyncIterator=T,t.async=function(e,n,r,a,i){void 0===i&&(i=Promise);var s=new T(c(e,n,r,a),i);return t.isGeneratorFunction(n)?s:s.next().then((function(t){return t.done?t.value:s.next()}))},w(g),p(g,u,"Generator"),p(g,s,(function(){return this})),p(g,"toString",(function(){return"[object Generator]"})),t.keys=function(t){var e=Object(t),n=[];for(var r in e)n.push(r);return n.reverse(),function t(){for(;n.length;){var r=n.pop();if(r in e)return t.value=r,t.done=!1,t}return t.done=!0,t}},t.values=C,M.prototype={constructor:M,reset:function(t){if(this.prev=0,this.next=0,this.sent=this._sent=void 0,this.done=!1,this.delegate=null,this.method="next",this.arg=void 0,this.tryEntries.forEach(L),!t)for(var e in this)"t"===e.charAt(0)&&n.call(this,e)&&!isNaN(+e.slice(1))&&(this[e]=void 0)},stop:function(){this.done=!0;var t=this.tryEntries[0].completion;if("throw"===t.type)throw t.arg;return this.rval},dispatchException:function(t){if(this.done)throw t;var e=this;function r(n,r){return s.type="throw",s.arg=t,e.next=n,r&&(e.method="next",e.arg=void 0),!!r}for(var a=this.tryEntries.length-1;a>=0;--a){var i=this.tryEntries[a],s=i.completion;if("root"===i.tryLoc)return r("end");if(i.tryLoc<=this.prev){var o=n.call(i,"catchLoc"),u=n.call(i,"finallyLoc");if(o&&u){if(this.prev<i.catchLoc)return r(i.catchLoc,!0);if(this.prev<i.finallyLoc)return r(i.finallyLoc)}else if(o){if(this.prev<i.catchLoc)return r(i.catchLoc,!0)}else{if(!u)throw new Error("try statement without catch or finally");if(this.prev<i.finallyLoc)return r(i.finallyLoc)}}}},abrupt:function(t,e){for(var r=this.tryEntries.length-1;r>=0;--r){var a=this.tryEntries[r];if(a.tryLoc<=this.prev&&n.call(a,"finallyLoc")&&this.prev<a.finallyLoc){var i=a;break}}i&&("break"===t||"continue"===t)&&i.tryLoc<=e&&e<=i.finallyLoc&&(i=null);var s=i?i.completion:{};return s.type=t,s.arg=e,i?(this.method="next",this.next=i.finallyLoc,l):this.complete(s)},complete:function(t,e){if("throw"===t.type)throw t.arg;return"break"===t.type||"continue"===t.type?this.next=t.arg:"return"===t.type?(this.rval=this.arg=t.arg,this.method="return",this.next="end"):"normal"===t.type&&e&&(this.next=e),l},finish:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var n=this.tryEntries[e];if(n.finallyLoc===t)return this.complete(n.completion,n.afterLoc),L(n),l}},catch:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var n=this.tryEntries[e];if(n.tryLoc===t){var r=n.completion;if("throw"===r.type){var a=r.arg;L(n)}return a}}throw new Error("illegal catch attempt")},delegateYield:function(t,e,n){return this.delegate={iterator:C(t),resultName:e,nextLoc:n},"next"===this.method&&(this.arg=void 0),l}},t}function s(t,e,n,r,a,i,s){try{var o=t[i](s),u=o.value}catch(t){return void n(t)}o.done?e(u):Promise.resolve(u).then(r,a)}function o(t){return function(){var e=this,n=arguments;return new Promise((function(r,a){var i=t.apply(e,n);function o(t){s(i,r,a,o,u,"next",t)}function u(t){s(i,r,a,o,u,"throw",t)}o(void 0)}))}}function u(){return(u=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(t[r]=n[r])}return t}).apply(this,arguments)}function p(t,e){return e||(e=t.slice(0)),t.raw=e,t}(e=exports.TestCaseVerdict||(exports.TestCaseVerdict={}))[e.Accepted=0]="Accepted",e[e.WrongAnswer=1]="WrongAnswer",e[e.Revert=2]="Revert";var c=null;function y(t,e){return t.toLowerCase()===e.toLowerCase()}"undefined"!=typeof window&&(c=require("@agnostico/browser-solidity-compiler"));var l="";function d(){return m.apply(this,arguments)}function m(){return(m=o(i().mark((function t(){var e;return i().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(""===l){t.next=2;break}return t.abrupt("return",l);case 2:return t.next=4,c.getCompilerVersions();case 4:return t.abrupt("return",l=(e=t.sent).releases[e.latestRelease]);case 7:case"end":return t.stop()}}),t)})))).apply(this,arguments)}function f(){return(f=o(i().mark((function t(e){var n,r,a,s,o,u;return i().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,d();case 2:return r=t.sent,t.next=5,c.solidityCompiler({version:"https://binaries.soliditylang.org/bin/"+r,contractBody:e});case 5:if(s=null!=(n=(a=t.sent).errors)?n:[],!((o=s.filter((function(t){return"error"===t.severity}))).length>0)){t.next=10;break}return t.abrupt("return",{bytecode:"",errors:o.map((function(t){return{msg:t.formattedMessage,code:t.errorCode}}))});case 10:u=a.contracts.Compiled_Contracts,t.t0=i().keys(u);case 12:if((t.t1=t.t0()).done){t.next=17;break}return t.abrupt("return",{bytecode:"0x"+u[t.t1.value].evm.bytecode.object,errors:[]});case 17:return t.abrupt("return",{bytecode:"",errors:[{msg:"Compilation failed - no contract found",code:"6969"}]});case 18:case"end":return t.stop()}}),t)})))).apply(this,arguments)}var h,b=[{anonymous:!1,inputs:[{indexed:!1,internalType:"uint256",name:"deadline",type:"uint256"}],name:"DeadlineUpdated",type:"event"},{anonymous:!1,inputs:[{indexed:!1,internalType:"address",name:"contestant",type:"address"},{indexed:!1,internalType:"bytes32",name:"solutionHash",type:"bytes32"}],name:"DeclareSolutionHash",type:"event"},{anonymous:!1,inputs:[{indexed:!1,internalType:"uint8",name:"version",type:"uint8"}],name:"Initialized",type:"event"},{anonymous:!1,inputs:[{indexed:!1,internalType:"uint256",name:"version",type:"uint256"},{components:[{internalType:"bytes",name:"input",type:"bytes"},{internalType:"bytes32",name:"output",type:"bytes32"},{internalType:"uint224",name:"gasLimit",type:"uint224"}],indexed:!1,internalType:"struct TestCase[]",name:"tests",type:"tuple[]"}],name:"NewTestVersion",type:"event"},{anonymous:!1,inputs:[{indexed:!1,internalType:"address",name:"contestant",type:"address"},{indexed:!1,internalType:"uint256",name:"point",type:"uint256"},{indexed:!1,internalType:"bool",name:"isPreDeadlineSolution",type:"bool"},{indexed:!1,internalType:"enum Verdict[]",name:"verdicts",type:"uint8[]"}],name:"RunSolution",type:"event"},{anonymous:!1,inputs:[{indexed:!1,internalType:"address",name:"contestant",type:"address"},{indexed:!1,internalType:"bool",name:"isPreDeadlineSolution",type:"bool"},{indexed:!1,internalType:"address",name:"solution",type:"address"}],name:"UpdateSolution",type:"event"},{inputs:[],name:"MAX_OUTPUT_SIZE",outputs:[{internalType:"uint16",name:"",type:"uint16"}],stateMutability:"view",type:"function"},{inputs:[{components:[{internalType:"bytes",name:"input",type:"bytes"},{internalType:"bytes32",name:"output",type:"bytes32"},{internalType:"uint224",name:"gasLimit",type:"uint224"}],internalType:"struct TestCase",name:"test",type:"tuple"}],name:"addTest",outputs:[],stateMutability:"nonpayable",type:"function"},{inputs:[],name:"author",outputs:[{internalType:"address",name:"",type:"address"}],stateMutability:"view",type:"function"},{inputs:[],name:"checker",outputs:[{internalType:"address",name:"",type:"address"}],stateMutability:"view",type:"function"},{inputs:[{internalType:"address",name:"",type:"address"}],name:"contestants",outputs:[{internalType:"bytes32",name:"solutionHash",type:"bytes32"},{internalType:"address",name:"solutionPreDeadline",type:"address"},{internalType:"address",name:"solutionPosDeadline",type:"address"},{internalType:"uint24",name:"pointPreDeadline",type:"uint24"},{internalType:"uint24",name:"pointPosDeadline",type:"uint24"}],stateMutability:"view",type:"function"},{inputs:[],name:"deadline",outputs:[{internalType:"uint256",name:"",type:"uint256"}],stateMutability:"view",type:"function"},{inputs:[{internalType:"bytes32",name:"solutionHash",type:"bytes32"}],name:"declareSolutionHash",outputs:[],stateMutability:"nonpayable",type:"function"},{inputs:[],name:"gateFactory",outputs:[{internalType:"address",name:"",type:"address"}],stateMutability:"view",type:"function"},{inputs:[{internalType:"address",name:"contestant",type:"address"}],name:"getContestantInfo",outputs:[{internalType:"bytes32",name:"solutionHash",type:"bytes32"},{internalType:"address",name:"solutionPreDeadline",type:"address"},{internalType:"address",name:"solutionPosDeadline",type:"address"},{internalType:"uint24",name:"pointPreDeadline",type:"uint24"},{internalType:"uint24",name:"pointPosDeadline",type:"uint24"}],stateMutability:"view",type:"function"},{inputs:[],name:"id",outputs:[{internalType:"uint256",name:"",type:"uint256"}],stateMutability:"view",type:"function"},{inputs:[{internalType:"uint256",name:"_id",type:"uint256"},{internalType:"address",name:"_author",type:"address"},{internalType:"address",name:"_checker",type:"address"},{internalType:"address",name:"_gateFactory",type:"address"}],name:"initialize",outputs:[],stateMutability:"nonpayable",type:"function"},{inputs:[{components:[{internalType:"bytes",name:"input",type:"bytes"},{internalType:"bytes32",name:"output",type:"bytes32"},{internalType:"uint224",name:"gasLimit",type:"uint224"}],internalType:"struct TestCase[]",name:"newTests",type:"tuple[]"}],name:"replaceTests",outputs:[],stateMutability:"nonpayable",type:"function"},{inputs:[{internalType:"address",name:"contestant",type:"address"},{internalType:"bool",name:"isBeforeDeadline",type:"bool"}],name:"runSolution",outputs:[],stateMutability:"nonpayable",type:"function"},{inputs:[{internalType:"uint256",name:"_deadline",type:"uint256"}],name:"setDeadline",outputs:[],stateMutability:"nonpayable",type:"function"},{inputs:[{internalType:"address",name:"user",type:"address"},{internalType:"bool",name:"isPreDeadlineSolution",type:"bool"},{internalType:"bytes",name:"solutionBytecode",type:"bytes"}],name:"submit",outputs:[],stateMutability:"nonpayable",type:"function"},{inputs:[{internalType:"address",name:"user",type:"address"},{internalType:"bool",name:"isPreDeadlineSolution",type:"bool"},{internalType:"bytes",name:"solutionBytecode",type:"bytes"}],name:"submitAndRunSolution",outputs:[],stateMutability:"nonpayable",type:"function"},{inputs:[],name:"testLength",outputs:[{internalType:"uint256",name:"",type:"uint256"}],stateMutability:"view",type:"function"},{inputs:[],name:"testVersion",outputs:[{internalType:"uint256",name:"",type:"uint256"}],stateMutability:"view",type:"function"},{inputs:[{internalType:"uint256",name:"",type:"uint256"}],name:"tests",outputs:[{internalType:"bytes",name:"input",type:"bytes"},{internalType:"bytes32",name:"output",type:"bytes32"},{internalType:"uint224",name:"gasLimit",type:"uint224"}],stateMutability:"view",type:"function"}],v=[{anonymous:!1,inputs:[{indexed:!1,internalType:"uint256",name:"id",type:"uint256"},{indexed:!1,internalType:"address",name:"solution",type:"address"}],name:"Deployment",type:"event"},{anonymous:!1,inputs:[{indexed:!1,internalType:"uint8",name:"version",type:"uint8"}],name:"Initialized",type:"event"},{inputs:[{internalType:"bytes",name:"bytecode",type:"bytes"},{internalType:"bytes",name:"input",type:"bytes"}],name:"deployAndRun",outputs:[{internalType:"bytes",name:"output",type:"bytes"},{internalType:"uint256",name:"gasUsed",type:"uint256"}],stateMutability:"nonpayable",type:"function"},{inputs:[{internalType:"address",name:"_user",type:"address"},{internalType:"string",name:"_username",type:"string"}],name:"initialize",outputs:[],stateMutability:"nonpayable",type:"function"},{inputs:[],name:"nonce",outputs:[{internalType:"uint256",name:"",type:"uint256"}],stateMutability:"view",type:"function"},{inputs:[{internalType:"address",name:"",type:"address"}],name:"solutionId",outputs:[{internalType:"uint256",name:"",type:"uint256"}],stateMutability:"view",type:"function"},{inputs:[],name:"user",outputs:[{internalType:"address",name:"",type:"address"}],stateMutability:"view",type:"function"},{inputs:[],name:"username",outputs:[{internalType:"string",name:"",type:"string"}],stateMutability:"view",type:"function"}],g=[{inputs:[],stateMutability:"nonpayable",type:"constructor"},{anonymous:!1,inputs:[{indexed:!1,internalType:"address",name:"previousAdmin",type:"address"},{indexed:!1,internalType:"address",name:"newAdmin",type:"address"}],name:"AdminChanged",type:"event"},{anonymous:!1,inputs:[{indexed:!0,internalType:"address",name:"beacon",type:"address"}],name:"BeaconUpgraded",type:"event"},{anonymous:!1,inputs:[{indexed:!1,internalType:"address",name:"user",type:"address"},{indexed:!1,internalType:"string",name:"username",type:"string"},{indexed:!1,internalType:"address",name:"gate",type:"address"}],name:"CreateGate",type:"event"},{anonymous:!1,inputs:[{indexed:!1,internalType:"uint8",name:"version",type:"uint8"}],name:"Initialized",type:"event"},{anonymous:!1,inputs:[{indexed:!0,internalType:"address",name:"previousOwner",type:"address"},{indexed:!0,internalType:"address",name:"newOwner",type:"address"}],name:"OwnershipTransferred",type:"event"},{anonymous:!1,inputs:[{indexed:!0,internalType:"address",name:"implementation",type:"address"}],name:"Upgraded",type:"event"},{inputs:[],name:"claimOwnership",outputs:[],stateMutability:"nonpayable",type:"function"},{inputs:[{internalType:"string",name:"username",type:"string"}],name:"createGate",outputs:[{internalType:"address",name:"gate",type:"address"}],stateMutability:"nonpayable",type:"function"},{inputs:[{internalType:"address",name:"",type:"address"}],name:"gates",outputs:[{internalType:"address",name:"",type:"address"}],stateMutability:"view",type:"function"},{inputs:[],name:"implementation",outputs:[{internalType:"address",name:"",type:"address"}],stateMutability:"view",type:"function"},{inputs:[{internalType:"address",name:"_implementation",type:"address"}],name:"initialize",outputs:[],stateMutability:"nonpayable",type:"function"},{inputs:[],name:"owner",outputs:[{internalType:"address",name:"",type:"address"}],stateMutability:"view",type:"function"},{inputs:[],name:"pendingOwner",outputs:[{internalType:"address",name:"",type:"address"}],stateMutability:"view",type:"function"},{inputs:[],name:"proxiableUUID",outputs:[{internalType:"bytes32",name:"",type:"bytes32"}],stateMutability:"view",type:"function"},{inputs:[{internalType:"address",name:"newOwner",type:"address"},{internalType:"bool",name:"direct",type:"bool"},{internalType:"bool",name:"renounce",type:"bool"}],name:"transferOwnership",outputs:[],stateMutability:"nonpayable",type:"function"},{inputs:[{internalType:"address",name:"newImplementation",type:"address"}],name:"upgradeBeacon",outputs:[],stateMutability:"nonpayable",type:"function"},{inputs:[{internalType:"address",name:"newImplementation",type:"address"}],name:"upgradeTo",outputs:[],stateMutability:"nonpayable",type:"function"},{inputs:[{internalType:"address",name:"newImplementation",type:"address"},{internalType:"bytes",name:"data",type:"bytes"}],name:"upgradeToAndCall",outputs:[],stateMutability:"payable",type:"function"}],w=r.gql(h||(h=p(['\n    query Users($limit: Int!, $skip: Int!) {\n        data: users(first: $limit, orderBy: syncingIndex, where: { syncingIndex_gt: $skip }) {\n            gate\n            username: id\n            address: user\n        }\n        total: bundle(id: "users") {\n            syncingIndex\n        }\n    }\n']))),T=function(){function t(t){this.signer=void 0,this.gateFactory=void 0,this.signer=t,this.gateFactory=new n.Contract("0x76f74E939255d5b90E45736808b436Cc4299b84e",g,t)}var e=t.prototype;return e.getUsername=function(){var t=o(i().mark((function t(e){var r,a;return i().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,this.gateFactory.callStatic.gates(e);case 2:if((r=t.sent)!==n.ethers.constants.AddressZero){t.next=5;break}return t.abrupt("return","");case 5:return a=new n.Contract(r,v,this.signer),t.abrupt("return",a.callStatic.username());case 7:case"end":return t.stop()}}),t,this)})));return function(e){return t.apply(this,arguments)}}(),e.register=function(){var t=o(i().mark((function t(e){return i().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.t0=this.gateFactory.callStatic,t.next=3,this.signer.getAddress();case 3:return t.t1=t.sent,t.next=6,t.t0.gates.call(t.t0,t.t1);case 6:if(t.sent===n.ethers.constants.AddressZero){t.next=9;break}throw new Error("Already registered");case 9:return t.abrupt("return",this.gateFactory.createGate(e));case 10:case"end":return t.stop()}}),t,this)})));return function(e){return t.apply(this,arguments)}}(),t.users=function(){var t=o(i().mark((function t(e){var n,r,s,o,u,p;return i().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return s=void 0===(r=(n=void 0===e?{}:e).limit)?10:r,u=void 0===(o=n.skip)?0:o,t.next=3,a("https://api.thegraph.com/subgraphs/name/leduythuccs/solidity-judge",w,{limit:s,skip:u});case 3:return t.abrupt("return",{users:(p=t.sent).data,total:p.total.syncingIndex});case 5:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}(),t}();exports.ProblemSDK=function(){function t(t,e,r){this.problemConfig=void 0,this.userAddr=void 0,this.signer=void 0,this.gateFactory=void 0,this.problem=void 0,this.problemConfig=t,this.userAddr=e,this.signer=r,this.gateFactory=new n.Contract("0x76f74E939255d5b90E45736808b436Cc4299b84e",g,r),this.problem=new n.Contract(t.address,b,r)}var e=t.prototype;return e.addTest=function(){var t=o(i().mark((function t(e,r,a){var s,o;return i().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return s=this.encodeData(e,this.problemConfig.inputFormat),o=n.ethers.utils.keccak256(this.encodeData(r,this.problemConfig.outputFormat)),t.abrupt("return",this.problem.addTest({input:s,output:o,gasLimit:a}));case 3:case"end":return t.stop()}}),t,this)})));return function(e,n,r){return t.apply(this,arguments)}}(),e.replaceTests=function(){var t=o(i().mark((function t(e){var r,a=this;return i().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return r=e.map((function(t){return{gasLimit:t.gasLimit,input:a.encodeData(t.input,a.problemConfig.inputFormat),output:n.ethers.utils.keccak256(a.encodeData(t.output,a.problemConfig.outputFormat))}})),t.abrupt("return",this.problem.replaceTests(r));case 2:case"end":return t.stop()}}),t,this)})));return function(e){return t.apply(this,arguments)}}(),e.setDeadline=function(){var t=o(i().mark((function t(e){return i().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.abrupt("return",this.problem.setDeadline(Math.trunc(e.getTime()/1e3)));case 1:case"end":return t.stop()}}),t,this)})));return function(e){return t.apply(this,arguments)}}(),e.deployAndRunExample=function(){var t=o(i().mark((function t(e,r){var a,s,o,u,p;return i().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,this.gateFactory.callStatic.gates(this.userAddr);case 2:return a=new n.Contract(t.sent,v,this.signer),s=this.encodeData(e,this.problemConfig.inputFormat),t.next=7,a.callStatic.deployAndRun(r,s);case 7:return u=(o=t.sent).gasUsed,p=this.decodeData(o.output,this.problemConfig.outputFormat),t.abrupt("return",{output:p,gasUsed:u.toNumber()});case 12:case"end":return t.stop()}}),t,this)})));return function(e,n){return t.apply(this,arguments)}}(),e.declareSolutionHash=function(){var t=o(i().mark((function t(e){return i().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.abrupt("return",this.problem.declareSolutionHash(e));case 1:case"end":return t.stop()}}),t,this)})));return function(e){return t.apply(this,arguments)}}(),e.getContestantInfo=function(){var t=o(i().mark((function t(){return i().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.abrupt("return",this.problem.callStatic.getContestantInfo(this.userAddr));case 1:case"end":return t.stop()}}),t,this)})));return function(){return t.apply(this,arguments)}}(),e.getDeadline=function(){var t=o(i().mark((function t(){return i().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.abrupt("return",this.problem.callStatic.deadline().then((function(t){return new Date(1e3*t.toNumber())})));case 1:case"end":return t.stop()}}),t,this)})));return function(){return t.apply(this,arguments)}}(),e.submitAndRunSolution=function(){var t=o(i().mark((function t(e,n){return i().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return void 0===n&&(n=!1),t.abrupt("return",this.problem.submitAndRunSolution(this.userAddr,n,e,{gasLimit:8e6}));case 2:case"end":return t.stop()}}),t,this)})));return function(e,n){return t.apply(this,arguments)}}(),e.getTests=function(){var t=o(i().mark((function t(e){var n,r,a,s;return i().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return void 0===e&&(e={}),t.next=3,this.problem.callStatic.testLength(e);case 3:n=t.sent.toNumber(),r=[],a=0;case 6:if(!(a<n)){t.next=14;break}return t.next=9,this.problem.callStatic.tests(a,e);case 9:r.push({input:this.decodeData((s=t.sent).input,this.problemConfig.inputFormat),gasLimit:s.gasLimit.toNumber()});case 11:a++,t.next=6;break;case 14:return t.abrupt("return",r);case 15:case"end":return t.stop()}}),t,this)})));return function(e){return t.apply(this,arguments)}}(),e.getTxReceipt=function(){var t=o(i().mark((function t(e){var n;return i().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if("string"!=typeof e){t.next=7;break}return t.next=4,this.signer.provider.getTransactionReceipt(e);case 4:t.t0=t.sent,t.next=8;break;case 7:t.t0=e;case 8:if(!(n=t.t0)){t.next=11;break}return t.abrupt("return",n);case 11:return t.next=13,new Promise((function(t){return setTimeout(t,500)}));case 13:t.next=0;break;case 15:case"end":return t.stop()}}),t,this)})));return function(e){return t.apply(this,arguments)}}(),e.parseSubmissionVerdict=function(){var t=o(i().mark((function t(e){var n,r,a,s=this;return i().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,this.getTxReceipt(e);case 2:if(n=t.sent,r=this.problem.filters.RunSolution(),0!==(a=n.logs.filter((function(t){return y(t.topics[0],r.topics[0])})).map((function(t){var e=s.problem.interface.parseLog(t).args;return{contestant:e.contestant,version:0,isPreDeadlineSolution:e.isPreDeadlineSolution,point:e.point.toNumber()/100,verdicts:e.verdicts}}))).length){t.next=7;break}throw new Error("No RunSolution event found");case 7:return t.t0=u,t.t1={},t.t2=a[0],t.next=12,this.getTests({blockTag:n.blockNumber});case 12:return t.t3=t.sent,t.t4={tests:t.t3},t.abrupt("return",(0,t.t0)(t.t1,t.t2,t.t4));case 15:case"end":return t.stop()}}),t,this)})));return function(e){return t.apply(this,arguments)}}(),e.decodeData=function(t,e){return n.ethers.utils.defaultAbiCoder.decode(e,t).map((function(t){return Array.isArray(t)?t.map((function(t){return t.toString()})).join(","):t.toString()}))},e.encodeData=function(t,e){var r=t.map((function(t,n){return e[n].endsWith("[]")?t.toString().split(","):t}));return n.ethers.utils.defaultAbiCoder.encode(e,r)},t}(),exports.USERS_QUERY=w,exports.UserSdk=T,exports.compileSolidity=function(t){return f.apply(this,arguments)},exports.getCompilerVersion=d,exports.isSameAddress=y;
//# sourceMappingURL=sdk.cjs.production.min.js.map
